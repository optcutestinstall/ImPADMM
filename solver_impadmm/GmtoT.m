% P
% from Gram to tensor
function D = GmtoT(G)
D = zeros(3,3,3,3);
D(1,1,1,1) = G(1,1);  %%
D(2,2,2,2) = G(2,2);  %%
D(3,3,3,3) = G(3,3);  %%%
D(1,1,2,2) = (G(1,2) + 0.5*G(4,4))/3; %%  6
D(1,1,3,3) = (G(1,3) + 0.5*G(5,5))/3; %%  6
D(2,2,3,3) = (G(2,3) + 0.5*G(6,6))/3;%%  6
D(1,1,1,2) = 0.5*G(1,4); %%  4
D(1,1,1,3) = 0.5*G(1,5); %%  4
D(1,2,2,2) = 0.5*G(2,4); %%  4
D(1,1,2,3) = (G(1,6) + G(4,5))/6; %%  12
D(1,2,2,3) = (G(2,5) + G(4,6))/6; %  12
D(1,2,3,3) = (G(3,4) + G(5,6))/6; %  12
D(2,2,2,3) = 0.5*G(2,6); %  4
D(1,3,3,3) = 0.5*G(3,5); %  4
D(2,3,3,3) = 0.5*G(3,6);% 4
D(1,2,1,2) = D(1,1,2,2);
D(1,2,2,1) = D(1,1,2,2);
D(2,1,1,2) = D(1,1,2,2);
D(2,1,2,1) = D(1,1,2,2);
D(2,2,1,1) = D(1,1,2,2);%
D(1,3,1,3) = D(1,1,3,3);
D(1,3,3,1) = D(1,1,3,3);
D(3,1,1,3) = D(1,1,3,3);
D(3,1,3,1) = D(1,1,3,3);
D(3,3,1,1) = D(1,1,3,3);%
D(2,3,2,3) = D(2,2,3,3);
D(2,3,3,2) = D(2,2,3,3);
D(3,2,2,3) = D(2,2,3,3);
D(3,2,3,2) = D(2,2,3,3);
D(3,3,2,2) = D(2,2,3,3);%
D(1,1,2,1) = D(1,1,1,2);
D(1,2,1,1) = D(1,1,1,2);
D(2,1,1,1) = D(1,1,1,2);%
D(1,1,3,1) = D(1,1,1,3);
D(1,3,1,1) = D(1,1,1,3);
D(3,1,1,1) = D(1,1,1,3);%
D(2,2,2,1) = D(1,2,2,2);
D(2,2,1,2) = D(1,2,2,2);
D(2,1,2,2) = D(1,2,2,2);%
D(1,1,3,2) = D(1,1,2,3);
D(1,2,1,3)= D(1,1,2,3);
D(1,2,3,1)= D(1,1,2,3);
D(1,3,1,2)= D(1,1,2,3);
D(1,3,2,1)= D(1,1,2,3);
D(2,1,1,3)= D(1,1,2,3);
D(2,1,3,1)= D(1,1,2,3);
D(2,3,1,1)= D(1,1,2,3);
D(3,1,1,2)= D(1,1,2,3);
D(3,1,2,1)= D(1,1,2,3);
D(3,2,1,1)= D(1,1,2,3);%
D(1,2,3,2)= D(1,2,2,3);
D(1,3,2,2)= D(1,2,2,3);
D(2,1,3,2)= D(1,2,2,3);
D(2,1,2,3)= D(1,2,2,3);
D(2,2,3,1)= D(1,2,2,3);
D(2,2,1,3)= D(1,2,2,3);
D(2,3,1,2)= D(1,2,2,3);
D(2,3,2,1)= D(1,2,2,3);
D(3,1,2,2)= D(1,2,2,3);
D(3,2,1,2)= D(1,2,2,3);
D(3,2,2,1)= D(1,2,2,3);%
D(1,3,2,3)= D(1,2,3,3);
D(1,3,3,2)= D(1,2,3,3);
D(2,1,3,3)= D(1,2,3,3);
D(2,3,1,3)= D(1,2,3,3);
D(2,3,3,1)= D(1,2,3,3);
D(3,3,2,1)= D(1,2,3,3);
D(3,3,1,2)= D(1,2,3,3);
D(3,1,3,2)= D(1,2,3,3);
D(3,1,2,3)= D(1,2,3,3);
D(3,2,1,3)= D(1,2,3,3);
D(3,2,3,1)= D(1,2,3,3);%
D(2,2,3,2) = D(2,2,2,3);
D(2,3,2,2)= D(2,2,2,3);
D(3,2,2,2)= D(2,2,2,3);%
D(3,1,3,3) = D(1,3,3,3);
D(3,3,1,3)= D(1,3,3,3);
D(3,3,3,1)= D(1,3,3,3);%
D(3,2,3,3) = D(2,3,3,3);
D(3,3,2,3) = D(2,3,3,3);
D(3,3,3,2) = D(2,3,3,3);
end

